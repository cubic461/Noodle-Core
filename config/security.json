{
  "security": {
    "version": "1.0.0",
    "enabled": true,
    "level": "high",
    "enforcement": {
      "strict": true,
      "block_on_failure": true,
      "notify_on_failure": true
    },
    "dependencies": {
      "safety": {
        "enabled": true,
        "fail_on_warning": false,
        "ignore_vulnerabilities": []
      },
      "pip_audit": {
        "enabled": true,
        "fail_on_warning": false,
        "ignore_vulnerabilities": []
      }
    },
    "secrets": {
      "trufflehog": {
        "enabled": true,
        "entropy_threshold": 4.5,
        "scan_history": true
      },
      "gitleaks": {
        "enabled": true,
        "config": ".gitleaks.toml"
      }
    },
    "sast": {
      "bandit": {
        "enabled": true,
        "confidence": "medium",
        "severity": "medium",
        "exclude_dirs": [
          "tests/",
          ".archive/",
          "node_modules/"
        ]
      },
      "semgrep": {
        "enabled": true,
        "config": "auto",
        "severity": "ERROR"
      }
    },
    "container": {
      "trivy": {
        "enabled": true,
        "severity": "HIGH,CRITICAL",
        "ignore_unfixed": false
      }
    },
    "codeql": {
      "enabled": true,
      "queries": [
        "security-extended",
        "security-and-quality"
      ]
    },
    "rate_limiting": {
      "enabled": true,
      "default": {
        "requests_per_minute": 60,
        "requests_per_hour": 1000
      },
      "api": {
        "requests_per_minute": 120,
        "requests_per_hour": 2000
      },
      "lsp": {
        "requests_per_minute": 300,
        "requests_per_hour": 5000
      }
    },
    "input_validation": {
      "enabled": true,
      "sanitize_input": true,
      "validate_types": true,
      "max_length": 10000,
      "allowed_characters": "a-zA-Z0-9_\\-\\s.,;:!?(){}[]"
    },
    "cors": {
      "enabled": true,
      "allowed_origins": [
        "http://localhost:3000",
        "http://localhost:8080",
        "https://noodlecore.io"
      ],
      "allowed_methods": [
        "GET",
        "POST",
        "PUT",
        "DELETE",
        "OPTIONS"
      ],
      "allowed_headers": [
        "Content-Type",
        "Authorization",
        "X-Request-ID"
      ],
      "max_age": 3600,
      "allow_credentials": true
    },
    "security_headers": {
      "enabled": true,
      "headers": {
        "X-Content-Type-Options": "nosniff",
        "X-Frame-Options": "DENY",
        "X-XSS-Protection": "1; mode=block",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "Content-Security-Policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://api.noodlecore.io;",
        "Referrer-Policy": "strict-origin-when-cross-origin",
        "Permissions-Policy": "geolocation=(), microphone=(), camera=()"
      }
    },
    "authentication": {
      "enabled": true,
      "jwt": {
        "enabled": true,
        "secret": "${NOODLE_JWT_SECRET}",
        "algorithm": "HS256",
        "expiration": 86400,
        "refresh_expiration": 604800
      },
      "oauth": {
        "enabled": true,
        "providers": {
          "github": {
            "enabled": true,
            "client_id": "${NOODLE_GITHUB_CLIENT_ID}",
            "client_secret": "${NOODLE_GITHUB_CLIENT_SECRET}"
          },
          "google": {
            "enabled": true,
            "client_id": "${NOODLE_GOOGLE_CLIENT_ID}",
            "client_secret": "${NOODLE_GOOGLE_CLIENT_SECRET}"
          }
        }
      },
      "session": {
        "enabled": true,
        "secret": "${NOODLE_SESSION_SECRET}",
        "max_age": 86400,
        "secure": true,
        "http_only": true,
        "same_site": "lax"
      }
    },
    "authorization": {
      "enabled": true,
      "rbac": {
        "enabled": true,
        "default_role": "user",
        "roles": {
          "admin": {
            "permissions": ["*"]
          },
          "developer": {
            "permissions": [
              "read:*",
              "write:code",
              "write:config",
              "execute:*"
            ]
          },
          "user": {
            "permissions": [
              "read:*",
              "execute:*"
            ]
          }
        }
      }
    },
    "audit_logging": {
      "enabled": true,
      "log_level": "info",
      "log_events": [
        "authentication",
        "authorization",
        "data_access",
        "data_modification",
        "configuration_change",
        "error"
      ],
      "retention_days": 90,
      "export_format": "json",
      "export_destination": "${NOODLE_AUDIT_LOG_DESTINATION}"
    },
    "encryption": {
      "enabled": true,
      "at_rest": {
        "enabled": true,
        "algorithm": "AES-256-GCM",
        "key": "${NOODLE_ENCRYPTION_KEY}"
      },
      "in_transit": {
        "enabled": true,
        "tls_version": "1.3",
        "ciphers": "TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256"
      }
    },
    "password_policy": {
      "enabled": true,
      "min_length": 12,
      "require_uppercase": true,
      "require_lowercase": true,
      "require_numbers": true,
      "require_special_chars": true,
      "max_age_days": 90,
      "history_count": 5,
      "prevent_common_passwords": true
    }
  }
}
