#!/USR/BIN/ENV PYTHON3
IMPORT SYS
IMPORT CSV
IMPORT OS

# ENSURE INPUT EXISTS
INPUT_PATH = SYS.ARGV[1] IF LEN(SYS.ARGV) > 1 ELSE 'SAMPLE_INPUT.CSV'
OUTPUT_PATH = SYS.ARGV[2] IF LEN(SYS.ARGV) > 2 ELSE 'TEST_OUTPUT.CSV'

IF NOT OS.PATH.EXISTS(INPUT_PATH):
    WITH OPEN(INPUT_PATH, 'W', NEWLINE='') AS F:
        WRITER = CSV.WRITER(F)
        WRITER.WRITEROW(['COL1', 'COL2'])
        WRITER.WRITEROW(['HELLO', 'WORLD'])
ELSE:
    WITH OPEN(INPUT_PATH, 'R', NEWLINE='') AS INFILE, OPEN(OUTPUT_PATH, 'W', NEWLINE='') AS OUTFILE:
        READER = CSV.READER(INFILE)
        WRITER = CSV.WRITER(OUTFILE)
        FOR ROW IN READER:
            NEW_ROW = [FIELD.UPPER() IF ISINSTANCE(FIELD, STR) ELSE FIELD FOR FIELD IN ROW]
            WRITER.WRITEROW(NEW_ROW)

"PRINT(F""PROCESSED {INPUT_PATH} -> {OUTPUT_PATH}"")"
