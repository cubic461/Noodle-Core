# Go Scaffolder

## Overview

The Go Scaffolder translates Python CLI tools into idiomatic Go code, generating stub implementations that maintain the same interface, file operations, and behavior while leveraging Go's type safety, concurrency, and performance benefits.

## Design Goals

1. **Interface Preservation**: Maintain identical CLI interface (flags, args, stdin/stdout)
2. **File Operations**: Translate file I/O patterns to Go equivalents
3. **Type Safety**: Leverage Go's type system for better reliability
4. **Performance**: Utilize Go's concurrency where beneficial
5. **Readability**: Generate clean, idiomatic Go code

## Research Summary

### Go CLI Frameworks

1. **cobra** (https://github.com/spf13/cobra)
   - Most popular CLI framework
   - Feature-rich with subcommands, flags, validation
   - Used by kubectl, Hugo, Docker
   - Recommended for complex CLIs

2. **urfave/cli** (https://github.com/urfave/cli)
   - Simpler, more minimal
   - Good for basic CLIs
   - Less boilerplate than cobra

3. **Standard library flag package**
   - Built-in, no dependencies
   - Limited features
   - Best for very simple CLIs

### File I/O Patterns

In Python, common patterns are:
- `with open(path, 'r') as f:`
- CSV, JSON, text file handling
- stdin/stdout redirection

Go equivalents:
- `os.Open()`, `os.Create()`
- `bufio.Scanner` for line-by-line reading
- `encoding/csv`, `encoding/json` packages
- `os.Stdin`, `os.Stdout`

### Argument Parsing

Python common patterns:
```python
import sys
args = sys.argv[1:]
# or with argparse
```

Go idioms:
```go
import (
    "flag"
    "os"
)
func main() {
    flag.Parse()
    args := flag.Args()
}
```

### Error Handling

Python:
```python
try:
    f = open(file)
except Exception as e:
    print(f"Error: {e}")
```

Go:
```go
f, err := os.Open(file)
if err != nil {
    fmt.Fprintf(os.Stderr, "Error: %v\n", err)
    os.Exit(1)
}
defer f.Close()
```

## Project Structure

```
go_scaffolder/
├── README.md              # This file
├── research.md            # Detailed research notes
├── go_scaffolder.py       # Main scaffold logic
├── templates/             # Go code templates
│   ├── main.tmpl         # Main function template
│   ├── structs.tmpl      # Type definitions
│   └── functions.tmpl    # Function templates
├── examples/              # Example translations
│   ├── simple_processor/ # From Python to Go
│   └── csv_tool/
└── tests/                 # Unit tests
```

## Implementation Plan

1. **Analyze Python Script**
   - Parse CLI arguments (argparse, sys.argv, click, etc.)
   - Detect file operations
   - Identify input/output patterns
   - Extract function signatures

2. **Generate Go Code**
   - Create main function with CLI setup
   - Generate structs for data types
   - Implement file operations
   - Add error handling
   - Include helpful comments

3. **Scaffold Project**
   - Create go.mod file
   - Set up project structure
   - Generate main.go
   - Add README with usage instructions

## Generated Code Pattern

```go
// Generated by NoodleCore Go Scaffolder
// DO NOT EDIT - This is a scaffolded version
package main

import (
    "bufio"
    "encoding/csv"
    "flag"
    "fmt"
    "io"
    "os"
    "strings"
)

type Config struct {
    InputPath  string
    OutputPath string
    Verbose    bool
}

func main() {
    config := parseArgs()
    if err := run(config); err != nil {
        fmt.Fprintf(os.Stderr, "Error: %v\n", err)
        os.Exit(1)
    }
}

func run(config *Config) error {
    // Implementation generated from Python script
    return nil
}

func parseArgs() *Config {
    // Generated argument parsing
}
```

## Translation Mappings

| Python Pattern | Go Equivalent |
|----------------|---------------|
| `print()` | `fmt.Println()` |
| `open(path, 'r')` | `os.Open(path)` |
| `open(path, 'w')` | `os.Create(path)` |
| `with open(...) as f:` | `f, err := os.Open(...)`<br>`if err != nil { ... }`<br>`defer f.Close()` |
| `for line in f:` | `scanner := bufio.NewScanner(f)`<br>`for scanner.Scan() {`<br>`    line := scanner.Text()` |
| `csv.reader` | `csv.NewReader()` |
| `csv.writer` | `csv.NewWriter()` |
| `sys.argv` | `flag.Args()` |
| `argparse` | `flag` package |
| `json.loads()` | `json.Unmarshal()` |
| `json.dumps()` | `json.Marshal()` |

## Next Steps

1. Implement basic Python script analysis
2. Create code generation templates
3. Build main scaffolder logic
4. Test with simple examples
5. Add support for more complex patterns
