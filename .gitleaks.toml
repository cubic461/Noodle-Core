# Gitleaks configuration for Noodle project
# This configuration detects secrets and sensitive data in the codebase

title = "Noodle Gitleaks Configuration"

# Extend the base configuration
[extend]
# Use default Gitleaks rules
useDefault = true

# Allowlist for false positives
[allowlist]
description = "Global allowlist"
paths = [
  '''node_modules''',
  '''vendor''',
  '''.git''',
  '''.venv''',
  '''venv''',
  '''__pycache__''',
  '''*.egg-info''',
  '''.pytest_cache''',
  '''.mypy_cache''',
  '''.tox''',
  '''build''',
  '''dist''',
  '''htmlcov''',
  '''.benchmarks''',
  '''coverage\.xml''',
  '''.coverage''',
  '''\.pyc''',
  '''\.pyo''',
  '''\.pyd''',
  '''\.so''',
  '''\.dll''',
  '''\.exe''',
  '''\.bin''',
  '''\.jar''',
  '''\.war''',
  '''\.ear''',
  '''\.zip''',
  '''\.tar''',
  '''\.gz''',
  '''\.7z''',
  '''\.rar''',
  '''\.iso''',
  '''\.img''',
  '''\.dmg''',
  '''\.pkg''',
  '''\.deb''',
  '''\.rpm''',
  '''\.apk''',
  '''\.aab''',
  '''\.ipa''',
  '''\.mov''',
  '''\.mp4''',
  '''\.avi''',
  '''\.mkv''',
  '''\.mp3''',
  '''\.wav''',
  '''\.flac''',
  '''\.ogg''',
  '''\.pdf''',
  '''\.doc''',
  '''\.docx''',
  '''\.xls''',
  '''\.xlsx''',
  '''\.ppt''',
  '''\.pptx''',
  '''\.odt''',
  '''\.ods''',
  '''\.odp''',
  '''\.jpg''',
  '''\.jpeg''',
  '''\.png''',
  '''\.gif''',
  '''\.bmp''',
  '''\.svg''',
  '''\.ico''',
  '''\.webp''',
  '''\.tiff''',
  '''\.psd''',
  '''\.ai''',
  '''\.sketch''',
  '''\.fig''',
  '''\.lock''',
  '''\.sum''',
  '''\.mod''',
  '''go\.sum''',
  '''package-lock\.json''',
  '''yarn\.lock''',
  '''pnpm-lock\.yaml''',
  '''composer\.lock''',
  '''Gemfile\.lock''',
  '''Cargo\.lock''',
  '''poetry\.lock''',
  '''Pipfile\.lock''',
  '''requirements\.txt''',
  '''pyproject\.toml''',
  '''setup\.py''',
  '''\.env\..*''',
  '''\.env''',
  '''\.secrets''',
  '''\.credentials''',
  '''\.keys''',
  '''\.pem''',
  '''\.key''',
  '''\.crt''',
  '''\.cert''',
  '''\.p12''',
  '''\.pfx''',
  '''\.der''',
  '''\.keystore''',
  '''\.jks''',
  '''\.truststore''',
  '''\.tsk''',
  '''\.kdbx''',
  '''\.kdb''',
  '''\.kwallet''',
  '''\.keychain''',
  '''\.asc''',
  '''\.gpg''',
  '''\.sig''',
  '''\.signature''',
  '''\.signature\.json''',
  '''\.minisig''',
  '''\.minisign''',
  '''\.sign''',
  '''\.pub''',
  '''\.public''',
  '''\.private''',
  '''\.secret''',
  '''\.token''',
  '''\.auth''',
  '''\.password''',
  '''\.pass''',
  '''\.creds''',
  '''\.credential''',
  '''\.config''',
  '''\.conf''',
  '''\.cfg''',
  '''\.ini''',
  '''\.json''',
  '''\.yaml''',
  '''\.yml''',
  '''\.toml''',
  '''\.xml''',
  '''\.properties''',
  '''\.sh''',
  '''\.bash''',
  '''\.zsh''',
  '''\.fish''',
  '''\.ps1''',
  '''\.bat''',
  '''\.cmd''',
  '''\.vbs''',
  '''\.js''',
  '''\.ts''',
  '''\.jsx''',
  '''\.tsx''',
  '''\.mjs''',
  '''\.cjs''',
  '''\.py''',
  '''\.rb''',
  '''\.go''',
  '''\.java''',
  '''\.kt''',
  '''\.scala''',
  '''\.cs''',
  '''\.cpp''',
  '''\.c''',
  '''\.h''',
  '''\.hpp''',
  '''\.rs''',
  '''\.swift''',
  '''\.dart''',
  '''\.php''',
  '''\.pl''',
  '''\.lua''',
  '''\.r''',
  '''\.m''',
  '''\.mm''',
  '''\.swift''',
  '''\.dart''',
  '''\.vue''',
  '''\.svelte''',
  '''\.astro''',
  '''\.md''',
  '''\.rst''',
  '''\.adoc''',
  '''\.txt''',
  '''\.log''',
  '''\.out''',
  '''\.err''',
  '''\.debug''',
  '''\.trace''',
  '''\.stacktrace''',
  '''\.dump''',
  '''\.core''',
  '''\.dmp''',
  '''\.min\.js''',
  '''\.min\.css''',
  '''\.bundle\.js''',
  '''\.chunk\.js''',
  '''\.vendor\.js''',
  '''\.vendor\.css''',
  '''\.map''',
  '''\.source\.map''',
  '''\.css\.map''',
  '''\.js\.map''',
  '''\.ts\.map''',
  '''\.tsx\.map''',
  '''\.jsx\.map''',
  '''test_.*\.py''',
  '''_test\.go''',
  '''_test\.rs''',
  '''_test\.java''',
  '''_test\.kt''',
  '''_test\.scala''',
  '''_test\.cs''',
  '''_test\.cpp''',
  '''_test\.c''',
  '''_test\.h''',
  '''_test\.hpp''',
  '''_test\.swift''',
  '''_test\.dart''',
  '''_test\.php''',
  '''_test\.rb''',
  '''_test\.pl''',
  '''_test\.lua''',
  '''_test\.r''',
  '''_test\.m''',
  '''_test\.mm''',
  '''_test\.vue''',
  '''_test\.svelte''',
  '''_test\.astro''',
  '''conftest\.py''',
  '''pytest\.ini''',
  '''tox\.ini''',
  '''setup\.cfg''',
  '''pyproject\.toml''',
  '''\.pre-commit-config\.yaml''',
  '''\.github''',
  '''.gitlab''',
  '''.bitbucket''',
  '''.circleci''',
  '''.travis''',
  '''.jenkins''',
  '''.drone''',
  '''.codeship''',
  '''.gitlab-ci\.yml''',
  '''.travis\.yml''',
  '''Jenkinsfile''',
  '''\.drone\.yml''',
  '''codeship-services\.yml''',
  '''codeship-steps\.yml''',
  '''\.azure-pipelines\.yml''',
  '''\.cloudbuild\.yml''',
  '''\.cloudbuild\.yaml''',
  '''\.appveyor\.yml''',
  '''\.circleci''',
  '''.circleci/config\.yml''',
  '''\.circleci/config\.yaml''',
  '''\.gitignore''',
  '''.dockerignore''',
  '''\.editorconfig''',
  '''\.eslintignore''',
  '''\.prettierignore''',
  '''\.stylelintignore''',
  '''\.flake8''',
  '''\.isortignore''',
  '''\.mypyignore''',
  '''\.pylintrc''',
  '''\.bandit''',
  '''\.snyk''',
  '''.gitleaks''',
  '''.trivyignore''',
  '''\.gitattributes''',
  '''\.gitmodules''',
  '''\.gitkeep''',
  '''\.git-blame-ignore-revs''',
  '''\.mailmap''',
  '''LICENSE''',
  '''LICENSE\..*''',
  '''COPYING''',
  '''COPYING\..*''',
  '''NOTICE''',
  '''AUTHORS''',
  '''CONTRIBUTORS''',
  '''CHANGELOG''',
  '''CHANGELOG\..*''',
  '''CHANGES''',
  '''CHANGES\..*''',
  '''HISTORY''',
  '''HISTORY\..*''',
  '''NEWS''',
  '''NEWS\..*''',
  '''README''',
  '''README\..*''',
  '''CONTRIBUTING''',
  '''CONTRIBUTING\..*''',
  '''CODE_OF_CONDUCT''',
  '''CODE_OF_CONDUCT\..*''',
  '''SECURITY''',
  '''SECURITY\..*''',
  '''SUPPORT''',
  '''SUPPORT\..*''',
  '''MAINTAINERS''',
  '''MAINTAINERS\..*''',
  '''RELEASE''',
  '''RELEASE\..*''',
  '''VERSION''',
  '''VERSION\..*''',
  '''\.version''',
  '''version\.txt''',
  '''\.release''',
  '''release\.txt''',
  '''\.changelog''',
  '''changelog\.txt''',
  '''\.changes''',
  '''changes\.txt''',
  '''\.history''',
  '''history\.txt''',
  '''\.news''',
  '''news\.txt''',
  '''\.readme''',
  '''readme\.txt''',
  '''\.contributing''',
  '''contributing\.txt''',
  '''\.code_of_conduct''',
  '''code_of_conduct\.txt''',
  '''\.security''',
  '''security\.txt''',
  '''\.support''',
  '''support\.txt''',
  '''\.maintainers''',
  '''maintainers\.txt''',
  '''\.release''',
  '''release\.txt''',
  '''\.version''',
  '''version\.txt''',
]

# Custom rules for Noodle project
[[rules]]
id = "noodle-api-key"
description = "Noodle API Key"
regex = '''(?i)(noodle[_-]?api[_-]?key|noodle[_-]?token|noodle[_-]?secret)["'\s]*[:=]["'\s]*[a-zA-Z0-9_\-]{20,}'''
keywords = ["noodle", "api", "key", "token", "secret"]
entropy = 3.5
secretGroup = 0

[[rules]]
id = "noodle-internal-key"
description = "Noodle Internal Key"
regex = '''(?i)(noodle[_-]?internal[_-]?key|noodle[_-]?private[_-]?key)["'\s]*[:=]["'\s]*[a-zA-Z0-9_\-]{32,}'''
keywords = ["noodle", "internal", "key", "private"]
entropy = 4.0
secretGroup = 0

[[rules]]
id = "database-connection-string"
description = "Database Connection String"
regex = '''(?i)(mongodb|mysql|postgresql|redis|sqlite|mssql|oracle)://[a-zA-Z0-9_\-]+:[^@/\s]+@[^/\s]+'''
keywords = ["mongodb://", "mysql://", "postgresql://", "redis://", "sqlite://", "mssql://", "oracle://"]
entropy = 2.5
secretGroup = 0

[[rules]]
id = "jwt-token"
description = "JSON Web Token"
regex = '''eyJ[a-zA-Z0-9_\-]+\.[a-zA-Z0-9_\-]+\.[a-zA-Z0-9_\-]+'''
keywords = ["eyJ"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "aws-access-key"
description = "AWS Access Key"
regex = '''(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}'''
keywords = ["A3T", "AKIA", "AGPA", "AIDA", "AROA", "AIPA", "ANPA", "ANVA", "ASIA"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Key"
regex = '''(?i)aws[_-]?secret[_-]?access[_-]?key["'\s]*[:=]["'\s]*[a-zA-Z0-9/+=]{40}'''
keywords = ["aws", "secret", "access", "key"]
entropy = 3.5
secretGroup = 0

[[rules]]
id = "google-api-key"
description = "Google API Key"
regex = '''AIza[0-9A-Za-z\-_]{35}'''
keywords = ["AIza"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "google-oauth"
description = "Google OAuth Token"
regex = '''ya29\.[0-9A-Za-z\-_]+'''
keywords = ["ya29"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "github-token"
description = "GitHub Personal Access Token"
regex = '''ghp_[a-zA-Z0-9]{36}'''
keywords = ["ghp_"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "github-oauth"
description = "GitHub OAuth Token"
regex = '''gho_[a-zA-Z0-9]{36}'''
keywords = ["gho_"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "github-app-token"
description = "GitHub App Token"
regex = '''(ghu|ghs|ghr)_[a-zA-Z0-9]{36}'''
keywords = ["ghu_", "ghs_", "ghr_"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "slack-token"
description = "Slack Token"
regex = '''xox[baprs]-[a-zA-Z0-9-]{10,48}'''
keywords = ["xoxb-", "xoxp-", "xoxa-", "xoxr-", "xoxs-"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "slack-webhook"
description = "Slack Webhook"
regex = '''https://hooks\.slack\.com/services/T[A-Z0-9]{8}/B[A-Z0-9]{8}/[a-zA-Z0-9]{24}'''
keywords = ["hooks.slack.com"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "stripe-api-key"
description = "Stripe API Key"
regex = '''(?i)stripe[_-]?(api[_-]?)?key["'\s]*[:=]["'\s]*(sk|pk)_(live|test)_[a-zA-Z0-9]{24,}'''
keywords = ["stripe", "sk_live", "pk_live", "sk_test", "pk_test"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "twilio-api-key"
description = "Twilio API Key"
regex = '''SK[a-f0-9]{32}'''
keywords = ["SK"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "heroku-api-key"
description = "Heroku API Key"
regex = '''(?i)heroku[_-]?(api[_-]?)?key["'\s]*[:=]["'\s]*[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'''
keywords = ["heroku", "api", "key"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "sendgrid-api-key"
description = "SendGrid API Key"
regex = '''SG\.[a-zA-Z0-9_-]{22}\.[a-zA-Z0-9_-]{43}'''
keywords = ["SG."]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "mailchimp-api-key"
description = "Mailchimp API Key"
regex = '''[0-9a-f]{32}-us[0-9]{1,2}'''
keywords = ["-us"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "private-key"
description = "Private Key"
regex = '''-----BEGIN (RSA |EC |DSA |OPENSSH |PGP )?PRIVATE KEY-----'''
keywords = ["-----BEGIN", "PRIVATE KEY"]
entropy = 0
secretGroup = 0

[[rules]]
id = "ssh-private-key"
description = "SSH Private Key"
regex = '''-----BEGIN OPENSSH PRIVATE KEY-----'''
keywords = ["-----BEGIN", "OPENSSH", "PRIVATE", "KEY"]
entropy = 0
secretGroup = 0

[[rules]]
id = "pem-certificate"
description = "PEM Certificate"
regex = '''-----BEGIN CERTIFICATE-----'''
keywords = ["-----BEGIN", "CERTIFICATE"]
entropy = 0
secretGroup = 0

[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|apikey|api[_-]?secret|apikey[_-]?secret|secret[_-]?key)["'\s]*[:=]["'\s]*[a-zA-Z0-9_\-]{16,}'''
keywords = ["api", "key", "secret"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "bearer-token"
description = "Bearer Token"
regex = '''Bearer [a-zA-Z0-9_\-\.]{20,}'''
keywords = ["Bearer"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "authorization-token"
description = "Authorization Token"
regex = '''(?i)authorization["'\s]*[:=]["'\s]*[a-zA-Z0-9_\-\.]{20,}'''
keywords = ["authorization"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "password-in-url"
description = "Password in URL"
regex = '''[a-zA-Z0-9_\-]+://[^/\s]+:[^@\s/]+@[^/\s]+'''
keywords = ["://", "@"]
entropy = 2.5
secretGroup = 0

[[rules]]
id = "base64-encoded-key"
description = "Base64 Encoded Key"
regex = '''(?i)(key|secret|token|password)["'\s]*[:=]["'\s]*[A-Za-z0-9+/]{40,}={0,2}'''
keywords = ["key", "secret", "token", "password"]
entropy = 3.5
secretGroup = 0

[[rules]]
id = "hex-encoded-key"
description = "Hex Encoded Key"
regex = '''(?i)(key|secret|token|password)["'\s]*[:=]["'\s]*[0-9a-fA-F]{32,}'''
keywords = ["key", "secret", "token", "password"]
entropy = 3.5
secretGroup = 0

[[rules]]
id = "docker-auth"
description = "Docker Auth"
regex = '''docker["'\s]*[:=]["'\s]*[a-zA-Z0-9_\-]{20,}'''
keywords = ["docker"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "npm-token"
description = "NPM Token"
regex = '''npm_[a-zA-Z0-9_-]{36}'''
keywords = ["npm_"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "pypi-token"
description = "PyPI Token"
regex = '''pypi-[a-zA-Z0-9_-]{36}'''
keywords = ["pypi-"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "azure-storage-key"
description = "Azure Storage Key"
regex = '''[a-zA-Z0-9+/]{88}=='''
keywords = ["DefaultEndpointsProtocol"]
entropy = 4.5
secretGroup = 0

[[rules]]
id = "azure-client-secret"
description = "Azure Client Secret"
regex = '''(?i)azure[_-]?client[_-]?secret["'\s]*[:=]["'\s]*[a-zA-Z0-9_\-\.]{30,}'''
keywords = ["azure", "client", "secret"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "datadog-api-key"
description = "Datadog API Key"
regex = '''(?i)datadog[_-]?api[_-]?key["'\s]*[:=]["'\s]*[a-zA-Z0-9]{32}'''
keywords = ["datadog", "api", "key"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "newrelic-api-key"
description = "New Relic API Key"
regex = '''(?i)newrelic[_-]?api[_-]?key["'\s]*[:=]["'\s]*[a-zA-Z0-9_\-]{40,}'''
keywords = ["newrelic", "api", "key"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "sentry-dsn"
description = "Sentry DSN"
regex = '''https://[a-f0-9]{32}@o[0-9]+\.ingest\.sentry\.io/[0-9]+'''
keywords = ["ingest.sentry.io"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "circleci-token"
description = "CircleCI Token"
regex = '''(?i)circle[_-]?token["'\s]*[:=]["'\s]*[a-f0-9]{40}'''
keywords = ["circle", "token"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "sonarqube-token"
description = "SonarQube Token"
regex = '''[a-f0-9]{40}'''
keywords = ["sonar"]
entropy = 3.0
secretGroup = 0

[[rules]]
id = "jira-token"
description = "Jira Token"
regex = '''(?i)jira[_-]?token["'\s]*[:=]["'\s]*[a-zA-Z0-9_\-]{24}'''
keywords = ["jira", "token"]
entropy = 3.0
secretGroup = 0
